<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Calculadora ONCE 2025</title>
<style>
:root {
  --bg:#0b1320; --fg:#e8eefc; --muted:#9bb0cc;
  --card:#111a2c; --accent:#4da3ff;
  --good:#2ecc71; --warn:#f1c40f; --bad:#e74c3c;
  --border:#344563; --focus:2px solid var(--accent);
}
body { background:var(--bg); color:var(--fg); font-family:sans-serif; margin:0; padding:1rem; }
h1,h2 { text-align:center; }
input { padding:0.4rem; border-radius:6px; border:1px solid var(--border); background:var(--card); color:var(--fg); }
.row { display:grid; grid-template-columns:1fr auto; gap:0.5rem; margin-bottom:0.8rem; }
.stepper-wrap{display:flex;gap:6px;align-items:center}
.stepper{display:flex;gap:6px}
.stepper button{padding:6px 8px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--fg);cursor:pointer}
.stepper button:focus{outline:var(--focus)}
.stepper button.neg{ border-color: var(--bad); }
.result { background:var(--card); padding:1rem; border-radius:8px; }
table { width:100%; border-collapse:collapse; margin-top:1rem; }
th,td { border:1px solid var(--border); padding:0.4rem; text-align:right; }
th { background:var(--card); }
button.reset { display:block; margin:1rem auto; background:var(--bad); color:white; border:none; padding:0.5rem 1rem; border-radius:8px; font-weight:bold; cursor:pointer; }
button.reset:hover { background:#c0392b; }
</style>
</head>
<body>
<h1>Calculadora de Comisiones ONCE 2025</h1>

<label>Día de la semana:
<select id="diaSelect">
  <option value="0">Lunes</option>
  <option value="1">Martes</option>
  <option value="2">Miércoles</option>
  <option value="3">Jueves</option>
  <option value="4">Viernes</option>
  <option value="5">Sábado</option>
  <option value="6">Domingo</option>
</select>
</label>

<h2>Ventas Normales</h2>
<div id="ventas"></div>

<h2>Extras</h2>
<div id="extras"></div>

<button class="reset" id="resetDia">Reiniciar día</button>

<div class="result">
  <p>Total ventas día: <span id="totalVentas">0,00 €</span></p>
  <p>Comisión día: <span id="totalComision">0,00 €</span></p>
</div>

<h2>Resumen semanal</h2>
<table id="tablaSemana">
<thead><tr><th>Día</th><th>Ventas</th><th>Comisión</th></tr></thead>
<tbody></tbody>
<tfoot><tr><th>Total</th><th id="totalSemana">0,00 €</th><th id="comiSemana">0,00 €</th></tr></tfoot>
</table>

<script>
// Configuración de productos
const productos = {
  normales: {
    nDiario: {precio:2, comi:0.06, nombre:"Diario"},
    nCuponazo: {precio:3, comi:0.06, nombre:"Cuponazo"},
    nSueldazo: {precio:3, comi:0.06, nombre:"Sueldazo"},
    libroR1: {precio:25, comi:0.05, nombre:"Rasca 1€"},
    libroR2: {precio:50, comi:0.05, nombre:"Rasca 2€"},
    libroR3: {precio:75, comi:0.05, nombre:"Rasca 3€"},
    libroR5: {precio:125, comi:0.05, nombre:"Rasca 5€"},
    libroR10: {precio:250, comi:0.05, nombre:"Rasca 10€"},
    nTriples: {precio:0.5, comi:0.05, nombre:"Triplex"},
    eurosSuperonce: {precio:1, comi:0.05, nombre:"SuperONCE (€)"},
    nMiDia: {precio:1, comi:0.05, nombre:"Mi Día"},
    nEurojackpot: {precio:2.5, comi:0.05, nombre:"Eurojackpot"}
  },
  extras: {
    extNavidad: {precio:20, comi:0.06, nombre:"Extra Navidad"},
    extDiaPadre: {precio:5, comi:0.06, nombre:"Extra Día del Padre"}
  }
};

// Crear inputs
function crearCampos(grupo, contenedorId){
  const cont = document.getElementById(contenedorId);
  cont.innerHTML = "";
  for(const id in productos[grupo]){
    const p = productos[grupo][id];
    const div = document.createElement("div");
    div.className = "row";
    const label = document.createElement("label");
    label.textContent = p.nombre + ": ";
    const input = document.createElement("input");
    input.type = "number";
    input.id = id;
    input.min = 0;
    input.value = 0;
    label.appendChild(input);
    div.appendChild(label);
    cont.appendChild(div);
  }
}
crearCampos("normales", "ventas");
crearCampos("extras", "extras");

// Botones rápidos
function attachSteppers(ids, steps=[-5,-1,1,5,10]){
  ids.forEach(id=>{
    const input = document.getElementById(id);
    if(!input || input.dataset.stepper==="1") return;
    input.dataset.stepper = "1";

    const wrap = document.createElement('div');
    wrap.className = 'stepper-wrap';
    const btns = document.createElement('div');
    btns.className = 'stepper';

    input.parentElement.insertBefore(wrap, input);
    wrap.appendChild(input);
    wrap.appendChild(btns);

    steps.forEach(s=>{
      const b = document.createElement('button');
      b.type = 'button';
      b.textContent = `${s>0?'+':''}${s}`;
      if(s<0) b.classList.add('neg');
      b.addEventListener('click', ()=>{
        const isMoney = input.id === 'eurosSuperonce';
        let cur = parseFloat(input.value||0);
        let next = cur + s;
        if(isMoney){
          if(next<0) next=0;
        }else{
          next = Math.max(0, Math.floor(next));
        }
        input.value = next;
        input.dispatchEvent(new Event('input',{bubbles:true}));
      });
      btns.appendChild(b);
    });
  });
}
attachSteppers([...Object.keys(productos.normales), ...Object.keys(productos.extras)]);

// Guardar/cargar por día
function keyDia(){ return "calcONCE2025_dia_"+document.getElementById("diaSelect").value; }

function guardarDia(){
  const datos = {};
  [...document.querySelectorAll("#ventas input,#extras input")].forEach(inp=>{
    datos[inp.id] = parseFloat(inp.value)||0;
  });
  localStorage.setItem(keyDia(), JSON.stringify(datos));
  actualizarSemana();
}

function cargarDia(){
  const datos = JSON.parse(localStorage.getItem(keyDia())||"{}");
  [...document.querySelectorAll("#ventas input,#extras input")].forEach(inp=>{
    inp.value = datos[inp.id]||0;
  });
  calc();
}

function calc(){
  let total=0, comi=0;
  [...document.querySelectorAll("#ventas input,#extras input")].forEach(inp=>{
    const grupo = productos.normales[inp.id] ? "normales" : "extras";
    const p = productos[grupo][inp.id];
    const val = parseFloat(inp.value)||0;
    total += val * p.precio;
    comi += val * p.precio * p.comi;
  });
  document.getElementById("totalVentas").textContent = total.toFixed(2)+" €";
  document.getElementById("totalComision").textContent = comi.toFixed(2)+" €";
  guardarDia();
}

function actualizarSemana(){
  const tbody = document.querySelector("#tablaSemana tbody");
  tbody.innerHTML = "";
  let totalSem=0, comiSem=0;
  for(let d=0; d<7; d++){
    const datos = JSON.parse(localStorage.getItem("calcONCE2025_dia_"+d)||"{}");
    let t=0,c=0;
    for(const id in datos){
      const grupo = productos.normales[id] ? "normales" : "extras";
      const p = productos[grupo][id];
      t += datos[id]*p.precio;
      c += datos[id]*p.precio*p.comi;
    }
    totalSem += t; comiSem += c;
    const tr = document.createElement("tr");
    const nombreDia = ["Lun","Mar","Mié","Jue","Vie","Sáb","Dom"][d];
    tr.innerHTML = `<td style="text-align:left">${nombreDia}</td><td>${t.toFixed(2)} €</td><td>${c.toFixed(2)} €</td>`;
    tbody.appendChild(tr);
  }
  document.getElementById("totalSemana").textContent = totalSem.toFixed(2)+" €";
  document.getElementById("comiSemana").textContent = comiSem.toFixed(2)+" €";
}

// Reiniciar día actual
document.getElementById("resetDia").addEventListener("click", ()=>{
  if(confirm("¿Seguro que quieres reiniciar este día?")){
    [...document.querySelectorAll("#ventas input,#extras input")].forEach(inp=> inp.value = 0);
    guardarDia();
    calc();
  }
});

// Eventos
document.getElementById("diaSelect").addEventListener("change", cargarDia);
document.querySelectorAll("#ventas input,#extras input").forEach(inp=>{
  inp.addEventListener("input", calc);
});

// Día actual por defecto
document.getElementById("diaSelect").value = new Date().getDay()-1;
if(document.getElementById("diaSelect").value < 0) document.getElementById("diaSelect").value = 6;
cargarDia();
actualizarSemana();
</script>
</body>
</html>
